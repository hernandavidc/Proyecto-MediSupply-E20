# Guía de estructura para microservicios FastAPI en este repositorio

## Objetivo
Todo nuevo microservicio (por ejemplo: `user-service`, `proveedor-service`, `credito-service`, etc.)
debe seguir la misma estructura de carpetas, módulos y convenciones que el proyecto base mostrado a continuación.

---

## 🏗️ Estructura esperada

```
scripts/
user-service/
│
├── app/
│   ├── api/
│   │   └── v1/
│   │       ├── __init__.py
│   │       ├── <nombre>_routes.py      # Rutas del microservicio (FastAPI routers)
│   │       └── ...
│   │
│   ├── core/
│   │   ├── __init__.py
│   │   ├── auth.py                     # Módulo de autenticación o JWT
│   │   ├── config.py                   # Configuración (BaseSettings, variables de entorno)
│   │   ├── database.py                 # Conexión a la BD (SQLAlchemy)
│   │   ├── dependencies.py             # Dependencias compartidas (DB, seguridad, etc.)
│   │   └── enums.py                    # Enumeraciones globales
│   │
│   ├── models/
│   │   ├── __init__.py
│   │   ├── <nombre>.py                 # Modelos ORM (SQLAlchemy)
│   │   └── ...
│   │
│   ├── schemas/
│   │   ├── __init__.py
│   │   ├── <nombre>_schema.py          # Modelos Pydantic (Request/Response)
│   │   └── ...
│   │
│   ├── services/
│   │   ├── __init__.py
│   │   ├── <nombre>_service.py         # Lógica de negocio (CRUD / orquestación)
│   │   └── ...
│   │
│   ├── main.py                         # Entry point de FastAPI (crea la app y monta routers)
│   └── __init__.py
│
├── tests/
│   ├── __init__.py
│   ├── test_<nombre>.py
│   └── ...
│
├── .dockerignore
├── .env.docker
├── .env.example
├── Dockerfile
├── pytest.ini
└── README.md
```

---

## 🧱 Convenciones

- **Framework principal:** FastAPI  
- **ORM:** SQLAlchemy  
- **Validación:** Pydantic  
- **Pruebas:** Pytest  
- **Contenedores:** Docker + docker-compose  
- **Autenticación:** JWT o API key según el caso  
- **Rutas:** agrupadas por versión (`api/v1/`)  
- **Prefijos de archivos:**  
  - `*_routes.py` → define endpoints  
  - `*_schema.py` → define Pydantic models  
  - `*_service.py` → contiene la lógica de negocio  
  - `*_model.py` → define tablas ORM (SQLAlchemy)  

---

## 🪄 Instrucciones para Copilot

Cuando generes un nuevo microservicio:
1. Crea una carpeta `app/` con las subcarpetas anteriores.
2. Crea un módulo `main.py` que registre los routers de `api/v1`.
3. Crea archivos `models`, `schemas` y `services` para cada entidad principal.
4. Implementa pruebas unitarias básicas dentro de `tests/`.
5. Usa `.env.example` como plantilla para variables sensibles.
6. Agrega `Dockerfile` y `.dockerignore` compatibles con FastAPI y Uvicorn.
7. Incluye dependencias mínimas en `requirements.txt` o `pyproject.toml`.

---

## 🧩 Ejemplo de boilerplate de ruta

```python
# app/api/v1/proveedor_routes.py
from fastapi import APIRouter, Depends
from app.schemas.proveedor_schema import ProveedorCreate, ProveedorResponse
from app.services.proveedor_service import crear_proveedor, obtener_proveedores

router = APIRouter(prefix="/proveedores", tags=["Proveedores"])

@router.post("/", response_model=ProveedorResponse)
async def crear(proveedor: ProveedorCreate):
    return await crear_proveedor(proveedor)

@router.get("/", response_model=list[ProveedorResponse])
async def listar():
    return await obtener_proveedores()
```

---

## 🚀 Resultado esperado

Cada nuevo microservicio generado por Copilot debe incluir:
- Estructura modular (api/core/models/schemas/services/tests)
- Configuración lista para Docker
- Rutas agrupadas por versión (`api/v1`)
- Buenas prácticas de separación de capas
- Pruebas automáticas básicas
- Documentación en `README.md`
