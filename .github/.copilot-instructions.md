# GuÃ­a de estructura para microservicios FastAPI en este repositorio

## Objetivo
Todo nuevo microservicio (por ejemplo: `user-service`, `proveedor-service`, `credito-service`, etc.)
debe seguir la misma estructura de carpetas, mÃ³dulos y convenciones que el proyecto base mostrado a continuaciÃ³n.

---

## ğŸ—ï¸ Estructura esperada

```
scripts/
user-service/
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ v1/
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ <nombre>_routes.py      # Rutas del microservicio (FastAPI routers)
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ auth.py                     # MÃ³dulo de autenticaciÃ³n o JWT
â”‚   â”‚   â”œâ”€â”€ config.py                   # ConfiguraciÃ³n (BaseSettings, variables de entorno)
â”‚   â”‚   â”œâ”€â”€ database.py                 # ConexiÃ³n a la BD (SQLAlchemy)
â”‚   â”‚   â”œâ”€â”€ dependencies.py             # Dependencias compartidas (DB, seguridad, etc.)
â”‚   â”‚   â””â”€â”€ enums.py                    # Enumeraciones globales
â”‚   â”‚
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ <nombre>.py                 # Modelos ORM (SQLAlchemy)
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ schemas/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ <nombre>_schema.py          # Modelos Pydantic (Request/Response)
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ <nombre>_service.py         # LÃ³gica de negocio (CRUD / orquestaciÃ³n)
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ main.py                         # Entry point de FastAPI (crea la app y monta routers)
â”‚   â””â”€â”€ __init__.py
â”‚
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_<nombre>.py
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ .dockerignore
â”œâ”€â”€ .env.docker
â”œâ”€â”€ .env.example
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ pytest.ini
â””â”€â”€ README.md
```

---

## ğŸ§± Convenciones

- **Framework principal:** FastAPI  
- **ORM:** SQLAlchemy  
- **ValidaciÃ³n:** Pydantic  
- **Pruebas:** Pytest  
- **Contenedores:** Docker + docker-compose  
- **AutenticaciÃ³n:** JWT o API key segÃºn el caso  
- **Rutas:** agrupadas por versiÃ³n (`api/v1/`)  
- **Prefijos de archivos:**  
  - `*_routes.py` â†’ define endpoints  
  - `*_schema.py` â†’ define Pydantic models  
  - `*_service.py` â†’ contiene la lÃ³gica de negocio  
  - `*_model.py` â†’ define tablas ORM (SQLAlchemy)  

---

## ğŸª„ Instrucciones para Copilot

Cuando generes un nuevo microservicio:
1. Crea una carpeta `app/` con las subcarpetas anteriores.
2. Crea un mÃ³dulo `main.py` que registre los routers de `api/v1`.
3. Crea archivos `models`, `schemas` y `services` para cada entidad principal.
4. Implementa pruebas unitarias bÃ¡sicas dentro de `tests/`.
5. Usa `.env.example` como plantilla para variables sensibles.
6. Agrega `Dockerfile` y `.dockerignore` compatibles con FastAPI y Uvicorn.
7. Incluye dependencias mÃ­nimas en `requirements.txt` o `pyproject.toml`.

---

## ğŸ§© Ejemplo de boilerplate de ruta

```python
# app/api/v1/proveedor_routes.py
from fastapi import APIRouter, Depends
from app.schemas.proveedor_schema import ProveedorCreate, ProveedorResponse
from app.services.proveedor_service import crear_proveedor, obtener_proveedores

router = APIRouter(prefix="/proveedores", tags=["Proveedores"])

@router.post("/", response_model=ProveedorResponse)
async def crear(proveedor: ProveedorCreate):
    return await crear_proveedor(proveedor)

@router.get("/", response_model=list[ProveedorResponse])
async def listar():
    return await obtener_proveedores()
```

---

## ğŸš€ Resultado esperado

Cada nuevo microservicio generado por Copilot debe incluir:
- Estructura modular (api/core/models/schemas/services/tests)
- ConfiguraciÃ³n lista para Docker
- Rutas agrupadas por versiÃ³n (`api/v1`)
- Buenas prÃ¡cticas de separaciÃ³n de capas
- Pruebas automÃ¡ticas bÃ¡sicas
- DocumentaciÃ³n en `README.md`
