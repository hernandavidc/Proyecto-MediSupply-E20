apiVersion: v1
kind: ConfigMap
metadata:
  name: postgres-init-scripts
  namespace: medisupply
data:
  init-db.sql: |
    -- Script de inicializaci√≥n para PostgreSQL
    -- Crea las bases de datos necesarias para los microservicios

    -- Crear base de datos para suppliers si no existe
    SELECT 'CREATE DATABASE suppliers_db'
    WHERE NOT EXISTS (SELECT FROM pg_database WHERE datname = 'suppliers_db')\gexec

    -- Conectar a la base de datos de suppliers
    \c suppliers_db;

    -- Crear extensiones necesarias
    CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

    -- Conectar a la base de datos de users (ya existe por POSTGRES_DB)
    \c users_db;

    -- Crear extensiones necesarias
    CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

    -- Mostrar bases de datos creadas
    \l
